<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KPI & Competency Dashboard</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="dashboard-container">
        <!-- Header -->
        <header class="dashboard-header">
            <div class="header-content">
                <h1>üìä KPI & Competency Dashboard</h1>
                <p class="subtitle">Performance & Competency Evaluation System</p>
            </div>
            <div class="header-actions">
                <button class="btn btn-primary" id="uploadExcel">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M8 3L8 11M8 3L5 6M8 3L11 6M3 13L13 13" stroke="currentColor" stroke-width="2" fill="none"/>
                    </svg>
                    Upload Excel
                </button>
                <button class="btn btn-secondary" id="exportData">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M8 11L8 3M8 11L5 8M8 11L11 8M3 13L13 13" stroke="currentColor" stroke-width="2" fill="none"/>
                    </svg>
                    Export Report
                </button>
            </div>
        </header>

        <!-- Summary Cards -->
        <div class="summary-section">
            <div class="summary-card overall">
                <div class="card-icon">üéØ</div>
                <div class="card-content">
                    <h3>Overall Score</h3>
                    <div class="metric-value" id="overallScore">0</div>
                    <div class="metric-label">Total Points</div>
                </div>
            </div>
            <div class="summary-card kpi">
                <div class="card-icon">üìà</div>
                <div class="card-content">
                    <h3>KPI Score</h3>
                    <div class="metric-value" id="kpiScore">0</div>
                    <div class="metric-label">Out of 100</div>
                </div>
            </div>
            <div class="summary-card competency">
                <div class="card-icon">‚≠ê</div>
                <div class="card-content">
                    <h3>Competency Score</h3>
                    <div class="metric-value" id="competencyScore">0</div>
                    <div class="metric-label">Out of 100</div>
                </div>
            </div>
            <div class="summary-card achievement">
                <div class="card-icon">üèÜ</div>
                <div class="card-content">
                    <h3>Achievement Rate</h3>
                    <div class="metric-value" id="achievementRate">0%</div>
                    <div class="metric-label">Target vs Actual</div>
                </div>
            </div>
        </div>

        <!-- Tabs -->
        <div class="tabs-container">
            <div class="tabs">
                <button class="tab active" data-tab="kpi">üìä KPI Performance</button>
                <button class="tab" data-tab="competency">‚≠ê SMART Competency</button>
                <button class="tab" data-tab="teams">üë• Teams & Roles</button>
                <button class="tab" data-tab="summary">üìã Summary & Insights</button>
            </div>
        </div>

        <!-- KPI Section -->
        <div class="content-section" id="kpiSection">
            <div class="section-card">
                <div class="section-header">
                    <h2>üìä KPI Sets</h2>
                    <button class="btn btn-primary" id="createKPISetBtn">
                        <span>+</span> Create New KPI Set
                    </button>
                </div>

                <div id="kpiSetsList">
                    <!-- KPI Sets will be rendered here -->
                </div>
            </div>
        </div>

        <!-- Competency Section -->
        <div class="content-section" id="competencySection" style="display: none;">
            <div class="section-card">
                <div class="section-header">
                    <h2>‚≠ê SMART Competency Assessment</h2>
                    <div class="legend">
                        <span class="legend-item role-model">Role Model</span>
                        <span class="legend-item guide">Guide</span>
                        <span class="legend-item improvement">Improvement</span>
                    </div>
                </div>

                <div class="competency-grid" id="competencyGrid">
                    <!-- Competencies will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Teams & Roles Section -->
        <div class="content-section" id="teamsSection" style="display: none;">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <!-- Teams Management -->
                <div class="section-card">
                    <div class="section-header">
                        <h2>üë• Teams</h2>
                        <button class="btn btn-primary" id="createTeamBtn">
                            <span>+</span> Create Team
                        </button>
                    </div>
                    <div id="teamsList">
                        <!-- Teams will be rendered here -->
                    </div>
                </div>

                <!-- Roles Management -->
                <div class="section-card">
                    <div class="section-header">
                        <h2>üé≠ Roles</h2>
                        <button class="btn btn-primary" id="createRoleBtn">
                            <span>+</span> Create Role
                        </button>
                    </div>
                    <div id="rolesList">
                        <!-- Roles will be rendered here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Summary Section -->
        <div class="content-section" id="summarySection" style="display: none;">
            <div class="section-card">
                <div class="section-header">
                    <h2>üìã Performance Summary & Insights</h2>
                </div>

                <div class="summary-grid">
                    <div class="summary-insight">
                        <h3>üéØ KPI Breakdown</h3>
                        <div class="breakdown-chart" id="kpiBreakdown"></div>
                    </div>

                    <div class="summary-insight">
                        <h3>‚≠ê Competency Distribution</h3>
                        <div class="competency-chart" id="competencyChart"></div>
                    </div>

                    <div class="summary-insight full-width">
                        <h3>üí° Recommendations & Next Steps</h3>
                        <div class="recommendations" id="recommendations">
                            <p>Complete your KPI and Competency assessments to see personalized recommendations.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- File Input (Hidden) -->
        <input type="file" id="excelFileInput" accept=".xlsx,.xls" style="display: none;">

        <!-- Hidden user/role options template -->
        <div id="userRoleOptionsTemplate" style="display: none;">
            <optgroup label="Roles">
                <option value="role:admin">Admin</option>
                <option value="role:member">Member</option>
                <option value="role:manager">Manager</option>
                <option value="role:team-lead">Team Lead</option>
                <option value="role:developer">Developer</option>
                <option value="role:designer">Designer</option>
                <option value="role:qa">QA Engineer</option>
            </optgroup>
            <optgroup label="Users" class="user-options-group">
                <!-- Users will be loaded dynamically -->
            </optgroup>
        </div>

        <!-- Create KPI Set Modal -->
        <div id="createKPISetModal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Create New KPI Set</h3>
                    <button class="close-modal" id="closeCreateKPISetModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>KPI Set Name</label>
                        <input type="text" id="newKPISetName" placeholder="e.g., Performance Evaluation Q1 2025" class="form-input">
                    </div>
                    <div class="form-group">
                        <label>Position/Level</label>
                        <select id="newKPISetPosition" class="form-input">
                            <option value="qa-head">Head of QA (KPI 70% / Competency 30%)</option>
                            <option value="qa-manager">QA Manager (KPI 65% / Competency 35%)</option>
                            <option value="qa-lead">QA Lead (KPI 60% / Competency 40%)</option>
                            <option value="qa-senior">Senior QA (KPI 55% / Competency 45%)</option>
                            <option value="qa-mid" selected>Mid-level QA (KPI 50% / Competency 50%)</option>
                            <option value="qa-junior">Junior QA (KPI 40% / Competency 60%)</option>
                            <option value="custom">Custom (KPI 50% / Competency 50%)</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" id="cancelCreateKPISet">Cancel</button>
                    <button class="btn btn-primary" id="confirmCreateKPISet">Create KPI Set</button>
                </div>
            </div>
        </div>

        <!-- Create/Edit Team Modal -->
        <div id="teamModal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="teamModalTitle">Create Team</h3>
                    <button class="close-modal" id="closeTeamModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Team Name</label>
                        <input type="text" id="teamName" placeholder="e.g., QA Team" class="form-input">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="teamDescription" placeholder="Team description..." class="form-input" rows="3"></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" id="cancelTeam">Cancel</button>
                    <button class="btn btn-primary" id="saveTeam">Save Team</button>
                </div>
            </div>
        </div>

        <!-- Create/Edit Role Modal -->
        <div id="roleModal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="roleModalTitle">Create Role</h3>
                    <button class="close-modal" id="closeRoleModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Role Name</label>
                        <input type="text" id="roleName" placeholder="e.g., Senior QA Engineer" class="form-input">
                    </div>
                    <div class="form-group">
                        <label>Position Level</label>
                        <select id="rolePosition" class="form-input">
                            <option value="qa-head">Head of QA (KPI 70% / Competency 30%)</option>
                            <option value="qa-manager">QA Manager (KPI 65% / Competency 35%)</option>
                            <option value="qa-lead">QA Lead (KPI 60% / Competency 40%)</option>
                            <option value="qa-senior">Senior QA (KPI 55% / Competency 45%)</option>
                            <option value="qa-mid">Mid-level QA (KPI 50% / Competency 50%)</option>
                            <option value="qa-junior">Junior QA (KPI 40% / Competency 60%)</option>
                            <option value="custom">Custom (KPI 50% / Competency 50%)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea id="roleDescription" placeholder="Role description..." class="form-input" rows="3"></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" id="cancelRole">Cancel</button>
                    <button class="btn btn-primary" id="saveRole">Save Role</button>
                </div>
            </div>
        </div>

        <!-- Manage Team Members Modal -->
        <div id="teamMembersModal" class="modal" style="display: none;">
            <div class="modal-content" style="max-width: 600px;">
                <div class="modal-header">
                    <h3 id="teamMembersTitle">Manage Team Members</h3>
                    <button class="close-modal" id="closeTeamMembersModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Add Member</label>
                        <select id="addMemberSelect" class="form-input">
                            <option value="">Select User</option>
                        </select>
                        <button class="btn btn-primary" id="addMemberBtn" style="margin-top: 8px;">Add to Team</button>
                    </div>
                    <div style="margin-top: 20px;">
                        <label style="font-weight: 600; margin-bottom: 12px; display: block;">Current Members</label>
                        <div id="teamMembersList">
                            <!-- Members will be rendered here -->
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" id="closeTeamMembers">Close</button>
                </div>
            </div>
        </div>

        <!-- Assign Modal -->
        <div id="assignModal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Assign to Roles/Users</h3>
                    <button class="close-modal" id="closeAssignModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div id="assignOptionsContainer">
                        <!-- Checkboxes will be rendered here -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" id="cancelAssign">Cancel</button>
                    <button class="btn btn-primary" id="confirmAssign">Save</button>
                </div>
            </div>
        </div>

        <!-- Add KPI Modal -->
        <div id="addKPIModal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Add New KPI</h3>
                    <button class="close-modal" id="closeAddKPIModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>KPI Name</label>
                        <input type="text" id="newKPIName" placeholder="e.g., Task Completion Rate" class="form-input">
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <input type="text" id="newKPIDescription" placeholder="Brief description" class="form-input">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Weight (%)</label>
                            <input type="number" id="newKPIWeight" min="0" max="100" value="25" class="form-input">
                        </div>
                        <div class="form-group">
                            <label>Target (%)</label>
                            <input type="number" id="newKPITarget" min="0" max="100" value="90" class="form-input">
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" id="cancelAddKPI">Cancel</button>
                    <button class="btn btn-primary" id="confirmAddKPI">Add KPI</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Include SheetJS for Excel parsing -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
