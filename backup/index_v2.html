<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planning Tool - Task Manager</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>üìã Planning Tool</h1>
        <div class="header-buttons">
            <a href="dashboard.html" style="text-decoration: none;">
                <button class="settings-btn">üìä Dashboard</button>
            </a>
            <button id="createTaskFloatingBtn" class="create-task-btn">‚ûï ‡∏™‡∏£‡πâ‡∏≤‡∏á Task</button>
            <button id="settingsBtn" class="settings-btn">‚öôÔ∏è Settings</button>
            <button id="reorderColumnsBtn" class="settings-btn">‚ÜïÔ∏è Reorder</button>
        </div>
    </header>

    <!-- Tab Navigation -->
    <div class="tab-navigation">
        <button class="tab-btn" data-tab="backlog">üì¶ Backlog</button>
        <button class="tab-btn active" data-tab="current">üöÄ Current</button>
    </div>

    <!-- Backlog Tab Content -->
    <div id="backlogTab" class="tab-content">
        <div class="backlog-filters">
            <button class="filter-btn active" data-size="all">All</button>
            <button class="filter-btn" data-size="S">S</button>
            <button class="filter-btn" data-size="M">M</button>
            <button class="filter-btn" data-size="L">L</button>
            <button class="filter-btn" data-size="XL">XL</button>
            <button class="create-backlog-btn" onclick="openCreateTaskModal(true)">‚ûï ‡∏™‡∏£‡πâ‡∏≤‡∏á Task ‡πÉ‡∏ô Backlog</button>
        </div>
        <div class="backlog-two-columns">
            <div class="backlog-column drop-zone" data-status="backlog">
                <h2>‚ö†Ô∏è Need More Details</h2>
                <p class="column-desc">Tasks ‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡∏Ç‡∏≤‡∏î‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</p>
                <div class="tasks-list" id="backlogNeedDetails"></div>
            </div>
            <div class="backlog-column drop-zone" data-status="backlogReady">
                <h2>‚úÖ Ready to Implement</h2>
                <p class="column-desc">Tasks ‡∏ó‡∏µ‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</p>
                <div class="tasks-list" id="backlogReady"></div>
            </div>
        </div>
    </div>

    <!-- Current Tab Content -->
    <div id="currentTab" class="tab-content active">
        <div class="current-controls">
            <button id="addColumnBtn" class="add-column-btn">‚ûï Add Column</button>
        </div>
        <div class="container" id="currentColumns">
            <!-- Columns will be rendered here dynamically -->
        </div>
    </div>

    <!-- Create Task Modal (Multi-Step) -->
    <div id="createTaskModal" class="modal">
        <div class="modal-content">
            <span class="close-create">&times;</span>
            <h2>‚ûï ‡∏™‡∏£‡πâ‡∏≤‡∏á Task ‡πÉ‡∏´‡∏°‡πà</h2>
            
            <!-- Progress Indicator -->
            <div class="progress-indicator">
                <div class="progress-step active" id="progressStep1">
                    <div class="step-number">1</div>
                    <div class="step-label">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô</div>
                </div>
                <div class="progress-line"></div>
                <div class="progress-step" id="progressStep2">
                    <div class="step-number">2</div>
                    <div class="step-label">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</div>
                </div>
            </div>
            
            <!-- Step 1: Basic Information -->
            <div id="step1" class="form-step active">
                <div class="form-group">
                    <label>‡∏ä‡∏∑‡πà‡∏≠ Task *</label>
                    <input type="text" id="taskTitle" placeholder="‡∏ä‡∏∑‡πà‡∏≠ Task" />
                </div>
                
                <div class="form-group">
                    <label>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</label>
                    <textarea id="taskDesc" placeholder="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î (optional)"></textarea>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>‡∏ä‡∏ô‡∏¥‡∏î *</label>
                        <select id="taskType"></select>
                    </div>
                    <div class="form-group">
                        <label>Priority *</label>
                        <select id="taskPriority"></select>
                    </div>
                </div>

                <div class="form-group">
                    <label>Backlog Size</label>
                    <select id="taskSize">
                        <option value="">-</option>
                        <option value="S">S - Small</option>
                        <option value="M">M - Medium</option>
                        <option value="L">L - Large</option>
                        <option value="XL">XL - Extra Large</option>
                    </select>
                </div>
                
                <div class="step-buttons">
                    <button class="btn-secondary" onclick="closeCreateTaskModal()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                    <button class="btn-primary" onclick="goToStep2()">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚Üí</button>
                </div>
            </div>
            
            <!-- Step 2: Additional Details -->
            <div id="step2" class="form-step">
                <div id="readinessChecklistContainer" class="checklist-container">
                    <h4>üìã Readiness Checklist</h4>
                    <p class="checklist-note">‚ö†Ô∏è ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ä‡πá‡∏Ñ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏Ç‡πâ‡∏≠ ‡∏ñ‡∏∂‡∏á‡∏à‡∏∞‡πÑ‡∏õ‡∏≠‡∏¢‡∏π‡πà "Ready to Implement" ‡πÑ‡∏î‡πâ</p>
                    <div id="readinessChecklist" class="checklist-items"></div>
                    <div id="noChecklistMessage" style="display: none; color: #666; font-style: italic; padding: 20px; text-align: center;">
                        ‚úÖ ‡∏ä‡∏ô‡∏¥‡∏î Task ‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏°‡∏µ Checklist<br>
                        <span style="font-size: 12px;">Task ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡πà Ready to Implement ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</span>
                    </div>
                </div>
                
                <div class="step-buttons">
                    <button class="btn-secondary" onclick="goToStep1()">‚Üê ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
                    <button id="createTaskBtn" class="btn-primary" onclick="createTask()">‡∏™‡∏£‡πâ‡∏≤‡∏á Task</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Backlog Task Modal -->
    <div id="editBacklogModal" class="modal">
        <div class="modal-content small">
            <span class="close" onclick="closeEditBacklogModal()">&times;</span>
            <h3>‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Task Details</h3>
            <input type="hidden" id="editBacklogTaskId">
            <div class="form-group">
                <label>Assignee</label>
                <input type="text" id="editAssignee" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö" />
            </div>
            <div class="form-group">
                <label>ETA (‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏™‡∏£‡πá‡∏à)</label>
                <input type="date" id="editETA" />
            </div>
            <div class="confirm-buttons">
                <button class="btn-secondary" onclick="closeEditBacklogModal()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button class="btn-primary" onclick="saveBacklogTaskDetails()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>
        </div>
    </div>

    <!-- Assignee & Points Modal -->
    <div id="assigneeModal" class="modal">
        <div class="modal-content small">
            <span class="close-assignee">&times;</span>
            <h3 id="assigneeModalTitle">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h3>
            <div class="form-group">
                <label>Assignee *</label>
                <input type="text" id="assigneeInput" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö" />
            </div>
            <div class="form-group">
                <label>Estimate Points *</label>
                <input type="number" id="estimateInput" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô Point" min="0" step="0.5" />
            </div>
            <div class="confirm-buttons">
                <button class="btn-secondary" onclick="closeAssigneeModal(false)">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button class="btn-primary" onclick="confirmAssignee()">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</button>
            </div>
        </div>
    </div>

    <!-- Actual Points Modal -->
    <div id="actualPointsModal" class="modal">
        <div class="modal-content small">
            <span class="close-actual">&times;</span>
            <h3>‡πÉ‡∏™‡πà Actual Points</h3>
            <div class="form-group">
                <label>Actual Points *</label>
                <input type="number" id="actualPointsInput" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô Point ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏à‡∏£‡∏¥‡∏á" min="0" step="0.5" />
            </div>
            <div class="confirm-buttons">
                <button class="btn-secondary" onclick="closeActualPointsModal(false)">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button class="btn-primary" onclick="confirmActualPoints()">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</button>
            </div>
        </div>
    </div>

    <!-- Task Detail Modal -->
    <div id="taskModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div id="taskDetailContent"></div>
        </div>
    </div>

    <!-- Dependency/Subtask Modal -->
    <div id="actionModal" class="modal">
        <div class="modal-content">
            <span class="close-action">&times;</span>
            <h2 id="actionTitle"></h2>
            <input type="text" id="actionTaskTitle" placeholder="‡∏ä‡∏∑‡πà‡∏≠ Task" />
            <textarea id="actionTaskDesc" placeholder="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î (optional)"></textarea>
            
            <div class="form-row">
                <div class="form-group">
                    <label>‡∏ä‡∏ô‡∏¥‡∏î:</label>
                    <select id="actionTaskType"></select>
                </div>
                <div class="form-group">
                    <label>Priority:</label>
                    <select id="actionTaskPriority"></select>
                </div>
            </div>
            
            <button id="actionCreateBtn" class="btn-primary">‡∏™‡∏£‡πâ‡∏≤‡∏á</button>
        </div>
    </div>

    <!-- Add Column Modal -->
    <div id="addColumnModal" class="modal">
        <div class="modal-content small">
            <span class="close-add-column">&times;</span>
            <h3>‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏° Column ‡πÉ‡∏´‡∏°‡πà</h3>
            <div class="form-group">
                <label>‡∏ä‡∏∑‡πà‡∏≠ Column *</label>
                <input type="text" id="newColumnName" placeholder="‡πÄ‡∏ä‡πà‡∏ô Review, Testing" />
            </div>
            <div class="confirm-buttons">
                <button class="btn-secondary" onclick="closeAddColumnModal()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button class="btn-primary" onclick="confirmAddColumn()">‡πÄ‡∏û‡∏¥‡πà‡∏°</button>
            </div>
        </div>
    </div>

    <!-- Column Reorder Modal -->
    <div id="reorderModal" class="modal">
        <div class="modal-content small">
            <span class="close-reorder">&times;</span>
            <h3>‚ÜïÔ∏è ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö Columns</h3>
            <p style="color: #666; font-size: 12px; margin-bottom: 15px;">‡∏•‡∏≤‡∏Å Column ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö (To Do ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏£‡∏Å‡πÄ‡∏™‡∏°‡∏≠, Done ‡∏≠‡∏¢‡∏π‡πà‡∏ó‡πâ‡∏≤‡∏¢‡πÄ‡∏™‡∏°‡∏≠)</p>
            <div id="reorderList" class="reorder-list"></div>
            <div class="confirm-buttons">
                <button class="btn-secondary" onclick="closeReorderModal()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button class="btn-primary" onclick="confirmReorder()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal">
        <div class="modal-content large">
            <span class="close-settings">&times;</span>
            <h2>‚öôÔ∏è ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</h2>
            
            <!-- Task Types Section -->
            <div class="section">
                <h3>üìã ‡∏ä‡∏ô‡∏¥‡∏î‡∏Ç‡∏≠‡∏á Task</h3>
                <div id="typesList" class="items-list"></div>
                <div class="add-form">
                    <input type="text" id="newType" placeholder="‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡∏ô‡∏¥‡∏î Task ‡πÉ‡∏´‡∏°‡πà..." />
                    <button class="add-btn" onclick="addType()">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°</button>
                </div>
            </div>

            <!-- Priorities Section -->
            <div class="section">
                <h3>‚ö° ‡∏£‡∏∞‡∏î‡∏±‡∏ö Priority</h3>
                <div id="prioritiesList" class="items-list"></div>
                <div class="add-form">
                    <input type="text" id="newPriority" placeholder="‡πÄ‡∏û‡∏¥‡πà‡∏° Priority ‡πÉ‡∏´‡∏°‡πà..." />
                    <button class="add-btn" onclick="addPriority()">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°</button>
                </div>
            </div>

            <!-- Priority Mapping Section -->
            <div class="section">
                <h3>üîó Mapping ‡∏ä‡∏ô‡∏¥‡∏î ‚Üí Priority</h3>
                <p class="section-desc">‡∏Å‡∏≥‡∏´‡∏ô‡∏î Priority ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ä‡∏ô‡∏¥‡∏î Task</p>
                <div id="priorityMappingContainer" class="mapping-container"></div>
            </div>

            <!-- Checklist Templates Section -->
            <div class="section">
                <h3>üìã Readiness Checklist Templates</h3>
                <p class="section-desc">‡∏Å‡∏≥‡∏´‡∏ô‡∏î Checklist ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ä‡∏ô‡∏¥‡∏î‡∏Ç‡∏≠‡∏á Task</p>
                <div id="checklistTemplatesContainer"></div>
            </div>

            <button class="btn-primary" onclick="saveSettings()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</button>
        </div>
    </div>

    <!-- Custom Alert Modal -->
    <div id="customAlertModal" class="modal">
        <div class="modal-content small">
            <h3 id="alertTitle"></h3>
            <p id="alertMessage"></p>
            <button class="btn-primary" onclick="closeCustomAlert()">‡∏ï‡∏Å‡∏•‡∏á</button>
        </div>
    </div>

    <!-- Custom Confirm Modal -->
    <div id="customConfirmModal" class="modal">
        <div class="modal-content small">
            <h3 id="confirmTitle"></h3>
            <p id="confirmMessage"></p>
            <div class="confirm-buttons">
                <button class="btn-secondary" onclick="closeCustomConfirm(false)">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button class="btn-primary" onclick="closeCustomConfirm(true)">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</button>
            </div>
        </div>
    </div>

    <script src="app_v2.js"></script>
</body>
</html>
